---
author: Boyu Ren
pubDatetime: &id001 2021-12-29 18:16:26
modDatetime: *id001
title: 25-两级页表
slug: 25-两级页表
featured: false
draft: false
tags:
- 操作系统
description: 某计算机系统按字节寻址，支持32位的逻辑地址，采用分页存储管理，页面大小为4KB，页表项长度为4B。
---

# 两级页表

## 单级页表的问题

某计算机系统按字节寻址，支持32位的逻辑地址，采用分页存储管理，页面大小为4KB，页表项长度为4B。

4KB = $2^{12}B$，因此页内地址要用12位表示，剩余20位表示页号。
因此，该系统中用户进程最多有220页。相应的，一个进程的页表中，最多会有220 = 1M = 1,048,576个页表项，所以一个页表最大需要220*4B=$2^{22}B$，共需要$2^{22}/2^{12}=2^{10}$个页框存储该页表。

根据页号查询页表的方法：K号页对应的页表项存放位置=页表始址＋K*4要在所有的页表项都连续存放的基础上才能用这种方法找到页表项

需要专门给进程分配$2^{10}=1024$个连续的页框来存放它的页表

同时根据局部性原理可知，很多时候，进程在一段时间内只需要访问某几个页面就可以正常运行了。因此没有必要让整个页表都常驻内存。

### 问题一:页表必须连续存放，因此当页表很大时，需要占用很多个连续的页框。

解决方法：我们在解决“进程在内存中必须连续存储问题”时将进程地址空间分页，并为其建立一张页表，记录各页面的存放位置。同样的思路也可用于解决“页表必须连续存放”的问题，把必须连续存放的页表再分页

可将长长的页表进行分组，使每个内存块刚好可以放入一个分组（比如上个例子中，页面大小4KB,每个页表项4B，每个页面可存放1K个页表项，因此每1K个连续的页表项为一组，每组刚好占一个内存块，再讲各组离散地放到各个内存块中）

另外，要为离散分配的页表再建立一张页表，称为页目录表，或称外层页表，或称顶层页表

![](https://ywrbyimg.oss-cn-chengdu.aliyuncs.com/img/QQ%E6%88%AA%E5%9B%BE20211229185116.png)

![](https://ywrbyimg.oss-cn-chengdu.aliyuncs.com/img/QQ%E6%88%AA%E5%9B%BE20211229185307.png)

![](https://ywrbyimg.oss-cn-chengdu.aliyuncs.com/img/QQ%E6%88%AA%E5%9B%BE20211229185457.png)

### 问题二:没有必要让整个页表常驻内存，因为进程在一段时间内可能只需要访问某几个特定的页面。

![](https://ywrbyimg.oss-cn-chengdu.aliyuncs.com/img/QQ%E6%88%AA%E5%9B%BE20211229185602.png)


### 注意

![](https://ywrbyimg.oss-cn-chengdu.aliyuncs.com/img/QQ%E6%88%AA%E5%9B%BE20211229185810.png)